---
config:
  layout: elk
  look: neo
  theme: redux-color
---
erDiagram
    USER ||--o{ SESSION_LOG : creates
    USER ||--o{ WASTE_PICKUP_REQUEST : makes
    USER ||--o{ ASSIGNMENT : performs
    USER ||--o{ WORKSHOP_REGISTRATION : joins
    USER ||--o{ POINTS_TRANSACTION : earns
    USER ||--|| CONTRIBUTION_PROFILE : has
    USER ||--o{ EXPORT_HISTORY : performs
    USER }|--|| ROLE : assigned

    ROLE {
        uuid role_id PK
        string role_name
        string permissions
    }

    USER {
        uuid user_id PK
        string name
        string email
        string phone
        string password_hash
        uuid role_id FK
        string address
        string profile_visibility
    }

    SESSION_LOG {
        uuid session_id PK
        uuid user_id FK
        string login_at
        string ip_address
        string device_info
    }

    WASTE_PICKUP_REQUEST ||--o{ ASSIGNMENT : assigned_to
    WASTE_PICKUP_REQUEST {
        uuid request_id PK
        uuid user_id FK
        string request_type
        string location
        string scheduled_time
        string status
    }

    SCHEDULE ||--o{ ASSIGNMENT : generates
    SCHEDULE {
        uuid schedule_id PK
        string recurrence_rule
        string time_of_day
        boolean is_active
    }

    ASSIGNMENT ||--o{ WASTE_RECORD : produces
    ASSIGNMENT {
        uuid assignment_id PK
        uuid driver_id FK
        uuid request_id FK
        string status
    }

    WASTE_RECORD {
        uuid record_id PK
        uuid assignment_id FK
        string waste_type
        float volume
        uuid validated_by FK
    }

    PARTNER ||--|| PARTNER_FACILITY : operates
    PARTNER {
        uuid partner_id PK
        string org_name
        string status
    }

    PARTNER_FACILITY ||--o{ WASTE_PICKUP_REQUEST : serves_as_location
    PARTNER_FACILITY {
        uuid facility_id PK
        uuid partner_id FK
        string location
    }

    WORKSHOP ||--o{ WORKSHOP_REGISTRATION : has_participants
    WORKSHOP {
        uuid workshop_id PK
        string title
        string date
        uuid created_by FK
    }

    WORKSHOP_REGISTRATION {
        uuid registration_id PK
        uuid user_id FK
        uuid workshop_id FK
    }

    POINTS_TRANSACTION }|--|| POINT_RULE : follows
    POINTS_TRANSACTION {
        uuid transaction_id PK
        uuid user_id FK
        integer points
        string timestamp
    }

    POINT_RULE {
        uuid rule_id PK
        string activity_type
        integer points_awarded
    }

    USER ||--o{ LEADERBOARD_ENTRY : ranked
    LEADERBOARD_ENTRY {
        uuid leaderboard_id PK
        uuid user_id FK
        integer score
        integer rank
        string period
    }

    CONTRIBUTION_PROFILE {
        uuid profile_id PK
        uuid user_id FK
        integer total_contributions
        float total_waste_volume
        string impact_summary
    }

    ANALYTICS_SNAPSHOT }|--|| EXPORT_HISTORY: recorded
    ANALYTICS_SNAPSHOT {
        uuid snapshot_id PK
        string metric_name
        float metric_value
        string generated_at
    }

    EXPORT_HISTORY {
        uuid export_id PK
        uuid admin_id FK
        string export_format
    }